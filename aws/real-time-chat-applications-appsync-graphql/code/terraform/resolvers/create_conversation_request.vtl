## Create Conversation Request Mapping Template
## Creates a new conversation with proper metadata and participant management

{
    "version": "2017-02-28",
    "operation": "PutItem",
    "key": {
        "conversationId": $util.dynamodb.toDynamoDBJson($util.autoId())
    },
    "attributeValues": {
        #if($ctx.args.input.name)
        "name": $util.dynamodb.toDynamoDBJson($ctx.args.input.name),
        #end
        "participants": $util.dynamodb.toDynamoDBJson($ctx.args.input.participants),
        "createdBy": $util.dynamodb.toDynamoDBJson($ctx.identity.sub),
        "createdAt": $util.dynamodb.toDynamoDBJson($util.time.nowISO8601()),
        "updatedAt": $util.dynamodb.toDynamoDBJson($util.time.nowISO8601()),
        "messageCount": $util.dynamodb.toDynamoDBJson(0),
        "isGroup": $util.dynamodb.toDynamoDBJson(#if($ctx.args.input.isGroup) $ctx.args.input.isGroup #else false #end)
    },
    "condition": {
        "expression": "attribute_not_exists(conversationId)"
    }
}