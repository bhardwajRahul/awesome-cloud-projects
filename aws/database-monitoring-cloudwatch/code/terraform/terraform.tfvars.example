# =============================================================================
# Example Terraform Variables File
# Database Monitoring Dashboards with CloudWatch
# =============================================================================
#
# Copy this file to terraform.tfvars and customize the values for your environment.
# DO NOT commit terraform.tfvars to version control as it may contain sensitive data.
#
# Usage:
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   terraform plan
#   terraform apply
#
# =============================================================================

# =============================================================================
# GENERAL CONFIGURATION
# =============================================================================

# Environment name (e.g., dev, staging, prod)
environment = "demo"

# Optional: Specify a custom random suffix for resource names
# random_suffix = "abc123"

# Additional tags for all resources
tags = {
  Owner       = "your-team"
  Environment = "demo"
  Project     = "database-monitoring"
  CostCenter  = "engineering"
}

# =============================================================================
# RDS DATABASE CONFIGURATION
# =============================================================================

# Database instance configuration
db_instance_identifier = "monitoring-demo"
db_engine             = "mysql"
db_engine_version     = "8.0.35"
db_instance_class     = "db.t3.micro"  # Good for development/testing

# Storage configuration
db_allocated_storage     = 20   # Minimum for MySQL
db_max_allocated_storage = 100  # Enable storage autoscaling up to 100 GB
db_storage_type         = "gp2" # General Purpose SSD
db_storage_encrypted    = true

# Database settings
db_name     = "monitoringdb"
db_username = "admin"
# Note: Password is auto-generated for security

# Network settings
db_publicly_accessible = false  # Keep private for security

# =============================================================================
# BACKUP & MAINTENANCE CONFIGURATION
# =============================================================================

# Backup settings
db_backup_retention_period = 7             # Keep backups for 7 days
db_backup_window          = "03:00-04:00"  # UTC time

# Maintenance settings
db_maintenance_window         = "sun:04:00-sun:05:00"  # UTC time
db_auto_minor_version_upgrade = true
db_apply_immediately         = false  # Apply changes during maintenance window

# Data protection
db_deletion_protection  = false  # Set to true for production
db_skip_final_snapshot = true   # Set to false for production

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Enhanced monitoring (collects OS-level metrics)
db_monitoring_interval = 60  # Collect metrics every 60 seconds

# Performance Insights (query-level performance data)
db_performance_insights_enabled         = true
db_performance_insights_retention_period = 7  # Free tier: 7 days

# CloudWatch Logs (enable specific log types)
db_enabled_cloudwatch_logs_exports = ["error", "general", "slow_query"]

# =============================================================================
# ALERTING CONFIGURATION
# =============================================================================

# SNS topic for alerts
sns_topic_name = "database-alerts"

# IMPORTANT: Replace with your actual email address to receive alerts
# Leave empty to skip email subscription
alert_email = "your-email@example.com"

# CloudWatch dashboard name
dashboard_name = "DatabaseMonitoring"

# =============================================================================
# ALARM THRESHOLDS (Customize based on your workload)
# =============================================================================

# CPU utilization alarm (percentage)
alarm_cpu_threshold         = 80  # Alert when CPU > 80%
alarm_cpu_evaluation_periods = 2   # Over 2 consecutive periods
alarm_cpu_period            = 300 # 5-minute periods

# Database connections alarm
alarm_connections_threshold         = 50  # Alert when connections > 50
alarm_connections_evaluation_periods = 2
alarm_connections_period            = 300

# Storage space alarm (bytes)
alarm_storage_threshold         = 2147483648  # Alert when < 2 GB free
alarm_storage_evaluation_periods = 1
alarm_storage_period            = 300

# Memory alarm (bytes)
alarm_memory_threshold         = 268435456  # Alert when < 256 MB free
alarm_memory_evaluation_periods = 2
alarm_memory_period            = 300

# Database load alarm (average active sessions)
alarm_db_load_threshold         = 2  # Alert when DB load > 2
alarm_db_load_evaluation_periods = 2
alarm_db_load_period            = 300

# Latency alarms (seconds)
alarm_read_latency_threshold         = 0.2  # Alert when read latency > 0.2s
alarm_read_latency_evaluation_periods = 2
alarm_read_latency_period            = 300

alarm_write_latency_threshold         = 0.2  # Alert when write latency > 0.2s
alarm_write_latency_evaluation_periods = 2
alarm_write_latency_period            = 300

# =============================================================================
# EXAMPLE CONFIGURATIONS FOR DIFFERENT ENVIRONMENTS
# =============================================================================

# Development Environment Example:
# db_instance_class = "db.t3.micro"
# db_allocated_storage = 20
# db_backup_retention_period = 1
# db_deletion_protection = false
# db_skip_final_snapshot = true

# Staging Environment Example:
# db_instance_class = "db.t3.small"
# db_allocated_storage = 50
# db_backup_retention_period = 7
# db_deletion_protection = true
# db_skip_final_snapshot = false

# Production Environment Example:
# db_instance_class = "db.r6g.large"
# db_allocated_storage = 100
# db_max_allocated_storage = 1000
# db_backup_retention_period = 30
# db_deletion_protection = true
# db_skip_final_snapshot = false
# db_performance_insights_retention_period = 731  # 2 years (additional cost)