{
    "widgets": [
        {
            "type": "metric",
            "x": 0,
            "y": 0,
            "width": 12,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/Lambda", "Invocations", "FunctionName", "${order_service_name}"],
                    [".", ".", ".", "${payment_service_name}"],
                    [".", ".", ".", "${inventory_service_name}"],
                    [".", ".", ".", "${notification_service_name}"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "Lambda Function Invocations",
                "period": 300,
                "stat": "Sum",
                "yAxis": {
                    "left": {
                        "min": 0
                    }
                }
            }
        },
        {
            "type": "metric",
            "x": 12,
            "y": 0,
            "width": 12,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/Lambda", "Errors", "FunctionName", "${order_service_name}"],
                    [".", ".", ".", "${payment_service_name}"],
                    [".", ".", ".", "${inventory_service_name}"],
                    [".", ".", ".", "${notification_service_name}"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "Lambda Function Errors",
                "period": 300,
                "stat": "Sum",
                "yAxis": {
                    "left": {
                        "min": 0
                    }
                }
            }
        },
        {
            "type": "metric",
            "x": 0,
            "y": 6,
            "width": 12,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/Lambda", "Duration", "FunctionName", "${order_service_name}"],
                    [".", ".", ".", "${payment_service_name}"],
                    [".", ".", ".", "${inventory_service_name}"],
                    [".", ".", ".", "${notification_service_name}"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "Lambda Function Duration",
                "period": 300,
                "stat": "Average",
                "yAxis": {
                    "left": {
                        "min": 0
                    }
                }
            }
        },
        {
            "type": "metric",
            "x": 12,
            "y": 6,
            "width": 12,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/States", "ExecutionsSucceeded", "StateMachineArn", "${state_machine_arn}"],
                    [".", "ExecutionsFailed", ".", "."],
                    [".", "ExecutionsStarted", ".", "."]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "Step Functions Executions",
                "period": 300,
                "stat": "Sum",
                "yAxis": {
                    "left": {
                        "min": 0
                    }
                }
            }
        },
        {
            "type": "metric",
            "x": 0,
            "y": 12,
            "width": 12,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/DynamoDB", "ConsumedReadCapacityUnits", "TableName", "${dynamodb_table_name}"],
                    [".", "ConsumedWriteCapacityUnits", ".", "."]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "DynamoDB Capacity Consumption",
                "period": 300,
                "stat": "Sum",
                "yAxis": {
                    "left": {
                        "min": 0
                    }
                }
            }
        },
        {
            "type": "metric",
            "x": 12,
            "y": 12,
            "width": 12,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/Events", "SuccessfulInvocations", "RuleName", "order-created-rule"],
                    [".", ".", ".", "payment-events-rule"],
                    [".", "FailedInvocations", ".", "order-created-rule"],
                    [".", ".", ".", "payment-events-rule"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "EventBridge Rule Invocations",
                "period": 300,
                "stat": "Sum",
                "yAxis": {
                    "left": {
                        "min": 0
                    }
                }
            }
        },
        {
            "type": "log",
            "x": 0,
            "y": 18,
            "width": 24,
            "height": 6,
            "properties": {
                "query": "SOURCE '/aws/lambda/${order_service_name}' | fields @timestamp, @message\n| filter @message like /ERROR/\n| sort @timestamp desc\n| limit 20",
                "region": "${aws_region}",
                "title": "Recent Lambda Errors"
            }
        },
        {
            "type": "metric",
            "x": 0,
            "y": 24,
            "width": 8,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/Lambda", "ConcurrentExecutions", "FunctionName", "${order_service_name}"],
                    [".", ".", ".", "${payment_service_name}"],
                    [".", ".", ".", "${inventory_service_name}"],
                    [".", ".", ".", "${notification_service_name}"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "Lambda Concurrent Executions",
                "period": 300,
                "stat": "Maximum"
            }
        },
        {
            "type": "metric",
            "x": 8,
            "y": 24,
            "width": 8,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/States", "ExecutionTime", "StateMachineArn", "${state_machine_arn}"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "Step Functions Execution Time",
                "period": 300,
                "stat": "Average"
            }
        },
        {
            "type": "metric",
            "x": 16,
            "y": 24,
            "width": 8,
            "height": 6,
            "properties": {
                "metrics": [
                    ["AWS/DynamoDB", "SuccessfulRequestLatency", "TableName", "${dynamodb_table_name}", "Operation", "PutItem"],
                    [".", ".", ".", ".", ".", "UpdateItem"],
                    [".", ".", ".", ".", ".", "GetItem"]
                ],
                "view": "timeSeries",
                "stacked": false,
                "region": "${aws_region}",
                "title": "DynamoDB Request Latency",
                "period": 300,
                "stat": "Average"
            }
        }
    ]
}