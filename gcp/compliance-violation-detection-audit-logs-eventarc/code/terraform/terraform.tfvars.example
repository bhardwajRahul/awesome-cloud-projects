# Example Terraform Variables for GCP Compliance Violation Detection
# Copy this file to terraform.tfvars and customize for your environment

# =============================================================================
# PROJECT AND LOCATION CONFIGURATION
# =============================================================================

# Your Google Cloud Project ID
# Example: "my-compliance-project-12345"
project_id = "your-gcp-project-id"

# Primary region for deploying resources
# Choose a region close to your users for optimal performance
# Example: "us-central1", "europe-west1", "asia-northeast1"
region = "us-central1"

# Environment designation (affects security settings and lifecycle policies)
# Options: "development", "staging", "production"
environment = "production"

# =============================================================================
# CLOUD FUNCTION CONFIGURATION
# =============================================================================

# Auto-scaling configuration for the compliance detection function
# Higher values support more concurrent audit log processing
function_max_instances = 100
function_min_instances = 1  # Set to 0 for cost optimization, 1+ for low latency

# Function resource allocation
function_memory = "512Mi"  # Options: "128Mi", "256Mi", "512Mi", "1Gi", "2Gi", "4Gi", "8Gi"
function_timeout_seconds = 540  # Maximum 540 seconds (9 minutes)

# Network security settings
function_ingress_settings = "ALLOW_INTERNAL_ONLY"  # Recommended for security

# VPC connectivity (optional)
enable_vpc_connector = false
vpc_connector_name = ""  # Only needed if enable_vpc_connector = true

# =============================================================================
# BIGQUERY CONFIGURATION
# =============================================================================

# Email address for BigQuery dataset ownership
# This user will have full access to the compliance data warehouse
dataset_owner_email = "admin@your-domain.com"

# Data retention policy in days
# Consider regulatory requirements (SOX: 7 years, GDPR: varies, etc.)
log_retention_days = 2555  # Approximately 7 years

# BigQuery location for data residency requirements
# Options: "US", "EU", or specific regions like "us-central1", "europe-west1"
bigquery_location = "US"

# =============================================================================
# COMPLIANCE MONITORING CONFIGURATION
# =============================================================================

# Enable/disable specific types of compliance monitoring
enable_iam_monitoring = true           # Critical for security frameworks
enable_data_access_monitoring = false  # High volume, enable for strict compliance
enable_admin_activity_monitoring = true # Recommended for most environments

# Define which violation types trigger high-severity alerts
high_severity_violation_types = [
  "IAM_POLICY_CHANGE",
  "PRIVILEGE_ESCALATION",
  "UNAUTHORIZED_ACCESS",
  "SECURITY_CONFIG_CHANGE"
]

# =============================================================================
# PUB/SUB MESSAGING CONFIGURATION
# =============================================================================

# Message retention and delivery settings
message_retention_duration = "1200s"  # 20 minutes
dead_letter_max_delivery_attempts = 5

# =============================================================================
# MONITORING AND ALERTING CONFIGURATION
# =============================================================================

# Enable notifications for compliance violations
enable_email_notifications = true

# Notification channels (create these in Cloud Console first)
# Get channel IDs with: gcloud alpha monitoring channels list
alert_notification_channels = [
  # "projects/your-project/notificationChannels/1234567890123456789",
  # "projects/your-project/notificationChannels/9876543210987654321"
]

# Alert management settings
alert_auto_close_duration = "1800s"        # 30 minutes
notification_rate_limit_period = "300s"    # 5 minutes to prevent flooding

# Dashboard and metrics configuration
enable_custom_metrics = true
enable_dashboard = true
dashboard_time_range = "1d"  # Options: "1h", "6h", "12h", "1d", "7d", "30d"

# =============================================================================
# AUDIT LOG CONFIGURATION
# =============================================================================

# Enable BigQuery sink for long-term compliance analysis
enable_audit_log_sink = true

# Custom filter for audit logs (leave empty for default comprehensive filter)
# Example: Focus on specific services or exclude noisy logs
audit_log_filter = ""

# Log exclusions to reduce costs (use with caution!)
enable_log_exclusions = false
log_exclusion_filters = [
  # Example exclusions (carefully review before enabling):
  # "protoPayload.serviceName=\"compute.googleapis.com\" AND protoPayload.methodName=\"compute.instances.list\"",
  # "protoPayload.serviceName=\"storage.googleapis.com\" AND protoPayload.methodName=\"storage.objects.get\""
]

# =============================================================================
# SECURITY AND ACCESS CONTROL
# =============================================================================

# Additional security optimizations
enable_cold_start_optimization = false  # Reduces latency but may increase costs

# =============================================================================
# RESOURCE LABELING AND ORGANIZATION
# =============================================================================

# Additional labels for resource organization, billing, and governance
additional_labels = {
  team         = "security"
  cost_center  = "compliance"
  owner        = "security-team@your-domain.com"
  purpose      = "compliance-monitoring"
  criticality  = "high"
  data_class   = "confidential"
}

# =============================================================================
# ENVIRONMENT-SPECIFIC EXAMPLES
# =============================================================================

# --- DEVELOPMENT ENVIRONMENT EXAMPLE ---
# Uncomment and modify for development environment:
#
# environment = "development"
# function_min_instances = 0
# log_retention_days = 90
# enable_data_access_monitoring = false
# bigquery_location = "us-central1"
# additional_labels = {
#   environment = "dev"
#   team = "security"
# }

# --- STAGING ENVIRONMENT EXAMPLE ---
# Uncomment and modify for staging environment:
#
# environment = "staging"
# function_min_instances = 0
# log_retention_days = 365
# enable_data_access_monitoring = true
# function_max_instances = 50
# additional_labels = {
#   environment = "staging"
#   team = "security"
# }

# --- HIGH-SECURITY PRODUCTION EXAMPLE ---
# Uncomment and modify for high-security production:
#
# environment = "production"
# function_min_instances = 2
# log_retention_days = 2555  # 7 years
# enable_data_access_monitoring = true
# enable_iam_monitoring = true
# enable_admin_activity_monitoring = true
# function_max_instances = 200
# bigquery_location = "us-central1"  # Single region for data residency
# enable_vpc_connector = true
# vpc_connector_name = "compliance-vpc-connector"

# =============================================================================
# COST OPTIMIZATION EXAMPLES
# =============================================================================

# --- COST-OPTIMIZED CONFIGURATION ---
# Uncomment for cost-conscious deployments:
#
# function_min_instances = 0
# function_memory = "256Mi"
# log_retention_days = 90
# enable_data_access_monitoring = false
# bigquery_location = "us-central1"
# enable_custom_metrics = false
# enable_cold_start_optimization = false

# =============================================================================
# COMPLIANCE FRAMEWORK EXAMPLES
# =============================================================================

# --- SOX COMPLIANCE CONFIGURATION ---
# log_retention_days = 2555  # 7 years minimum
# enable_iam_monitoring = true
# enable_admin_activity_monitoring = true
# enable_data_access_monitoring = true
# audit_log_filter = ""  # Comprehensive logging required

# --- GDPR COMPLIANCE CONFIGURATION ---
# log_retention_days = 2190  # 6 years typical
# bigquery_location = "europe-west1"  # EU region for data residency
# enable_data_access_monitoring = true
# additional_labels = {
#   data_classification = "personal_data"
#   gdpr_scope = "true"
# }

# --- HIPAA COMPLIANCE CONFIGURATION ---
# log_retention_days = 2190  # 6 years minimum
# enable_data_access_monitoring = true
# enable_vpc_connector = true
# function_ingress_settings = "ALLOW_INTERNAL_ONLY"
# additional_labels = {
#   hipaa_scope = "true"
#   data_classification = "phi"
# }